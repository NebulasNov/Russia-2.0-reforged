on_actions = {

	#SOU Gets Annexed By SOV and Receives Events
	on_capitulation = {
		effect = {
			if = {
				limit = {
					ROOT = {
						tag = SOU
					}
					FROM = {
						tag = SOV
						has_country_flag = second_civil_war_in_progress
					}
				}
				ROOT = {
					transfer_navy = {
						target = FROM
					}
				}	
				every_state = {
					limit = {
						is_owned_by = ROOT
					}
					FROM = {
						transfer_state = PREV
					}
				}
				if = {
					limit = {
						UKR = {
							OR = {
								is_in_faction_with = ROOT
								has_war_with = FROM
							}
						}
					}
					every_state = {
						limit = {
							is_owned_by = UKR
						}
						FROM = {
							transfer_state = PREV
							add_state_core = PREV
						}
					}
				}
				FROM = {
					country_event = { id = soviets.190 hours = 6 }
					news_event = { id = newsrussia2.67 days = 1 }
				}
				if = {
					limit = {
						FROM = {
							OR = {
								has_country_flag = japan_accept_to_help_give_russian_far_east
								has_country_flag = has_negotiated_with_germany_ressource_rights
								has_country_flag = accept_american_occupation_siberia_after_cw 
								has_country_flag = accept_french_factories_after_cw 
								has_country_flag = accept_diplomatic_relation_with_italy 
								has_country_flag = accept_english_help_for_shipment 
							}
						}
					}
					FROM = {
						country_event = { id = generics.34 days = 7 }
					}
				}
				every_country = {
					limit = {
						has_country_flag = has_helped_whiteguard_by_volunteers
					}
					country_event = { id = generics.35 days = 1 }
				}
			}
		}
	}

	#SOV Gets Annexed By SOU and Receives Events
	on_capitulation = {
		effect = {
			if = {
				limit = {
					ROOT = {
						tag = SOV
						has_country_flag = second_civil_war_in_progress
					}
					FROM = {
						tag = SOU
					}
				}
				ROOT = {
					transfer_navy = {
						target = FROM
					}
				}	
				every_state = {
					limit = {
						is_owned_by = ROOT
					}
					FROM = {
						transfer_state = PREV
					}
				}
				if = {
					limit = {
						OR = {
							TAG = UKR
							TAG = GEO
							TAG = BLR
							TAG = AZR
							TAG = ARM
							TAG = KAZ
							TAG = TMS
						}
					}
					SOU = {
						add_state_core = PREV
					}
				}
				FROM = {
					country_event = { id = soviets.238 hours = 3 }
					news_event = { id = newsrussia2.68 days = 1 }
				}

			}
		}
	}

	#Countries with the Russian agreement will not mess with Russian affairs
	on_declare_war = {
		effect = {
			if = {
				limit = {
					tag = SOV
					any_country = {
						has_idea = SOV_Root_russian_pact
					}
				}
				hidden_effect = {
					FROM = {
						set_country_flag = is_target_of_russia_with_agreement
					}
					every_country = {
						limit = {
							has_idea = SOV_Root_russian_pact
						}

						add_ai_strategy = {
							type = support
							id = FROM
							value = -1000
						}

						add_ai_strategy = {
							type = alliance
							id = FROM
							value = -1000
						}

						add_ai_strategy = {
							type = send_volunteers_desire
							id = FROM
							value = -1000
						}
					}
				}
			}
		}
	}

	#Undo the hostile behaviors towards Russian enemy
	on_capitulation = {
		effect = {
			if = {
				limit = {
					FROM = {
						has_country_flag = is_target_of_russia_with_agreement
					}
				}
				hidden_effect = {
					FROM = {
						clr_country_flag = is_target_of_russia_with_agreement
					}
					every_country = {
						limit = {
							has_idea = SOV_Root_russian_pact
						}

						add_ai_strategy = {
							type = support
							id = FROM
							value = 1000
						}

						add_ai_strategy = {
							type = alliance
							id = FROM
							value = 1000
						}

						add_ai_strategy = {
							type = send_volunteers_desire
							id = FROM
							value = 1000
						}
					}
				}
			}
		}
	}

	on_startup = {
		effect = {
			SOV = {
				if = {
					limit = {
						has_game_rule = {
							rule = RUS_ai_behavior
							option = RANDOM
						}
					}
					#Undo the Paradox nonsense country flags
					if = {
						limit = {
							has_country_flag = SOV_AI_RANDOM_COMMUNIST_HISTORICAL
						}
						clr_country_flag = SOV_AI_RANDOM_COMMUNIST_HISTORICAL
					}
					if = {
						limit = {
							has_country_flag = SOV_AI_RANDOM_COMMUNIST_ALTERNATE
						}
						clr_country_flag = SOV_AI_RANDOM_COMMUNIST_ALTERNATE
					}
					set_temp_variable = { random_sov_ai_factor = 0 }
					randomize_temp_variable = {
						var = random_sov_ai_factor
						distribution = uniform
						min = 1
						max = 4
					}
					round_temp_variable = random_sov_ai_factor
					#Communist
					if = {
						limit = {
							check_variable = {
								var = random_sov_ai_factor
								value = 1
								compare = equals
							}
						}
						set_country_flag = SOV_AI_RANDOM_COMMUNIST_BEHAVIOR
					}
					#Democratic
					else_if = {
						limit = {
							check_variable = {
								var = random_sov_ai_factor
								value = 2
								compare = equals
							}
						}
						set_country_flag = SOV_AI_RANDOM_DEMOCRATIC_BEHAVIOR
					}
					#Neutrality
					else_if = {
						limit = {
							check_variable = {
								var = random_sov_ai_factor
								value = 3
								compare = equals
							}
						}
						set_country_flag = SOV_AI_RANDOM_NEUTRAL_BEHAVIOR
					}
					#Fascist
					else_if = {
						limit = {
							check_variable = {
								var = random_sov_ai_factor
								value = 4
								compare = equals
							}
						}
						set_country_flag = SOV_AI_RANDOM_FASCIST_BEHAVIOR
					}
				}
			}
		}
	}

	#Revert capital to St Petersburg in case
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						state = 195
					}
					ROOT = {
						TAG = SOV
						has_country_flag = has_choosen_st_petersburg_as_capital
					}
					195 = {
						is_capital = no
					}
				}
				ROOT = {
					set_capital = 195
				}
			}
		}
	}
	
	#Rename Stalingrad to Volgograd if SOV is not the owner
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						state = 217
					}
					FROM = {
						TAG = SOV
					}
					217 = {
						NOT = {
							is_owned_and_controlled_by = SOV
						}
						is_controlled_by = ROOT
					}
					ROOT = {
						NOT = {
							original_tag = SOV
							has_government = communism
						}
					}
					NOT = {
						has_global_flag = renamed_stalingrad_sov
					}
				}
				set_global_flag = renamed_stalingrad_sov
				set_province_name = { id = 3529 name = "Volgograd"}
				217 = {
					set_state_name = "Volgograd"
				}
			}
			else_if = {
				limit = {
					FROM.FROM = {
						state = 217
					}
					ROOT = {
						TAG = SOV
						has_government = communism
					}
					217 = {
						NOT = {
							is_controlled_by = FROM
						}
						is_owned_and_controlled_by = ROOT
					}
					has_global_flag = renamed_stalingrad_sov
				}
				clr_global_flag = renamed_stalingrad_sov
				if = {
					limit = {
						has_country_leader = {
							name = "Leon Trotsky"
							ruling_only = yes
						}
					}
					set_province_name = { id = 3529 name = "Trotskygrad"}
					217 = {
						set_state_name = "Trotskygrad"
					}
				}
				else = {
					set_province_name = { id = 3529 name = "Stalingrad"}
					217 = {
						set_state_name = "Stalingrad"
					}
				}
			}
		}
	}

	#Rename Leningrad to St Petersburg if SOV is not the owner
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						state = 195
					}
					FROM = {
						TAG = SOV
					}
					195 = {
						NOT = {
							is_owned_and_controlled_by = SOV
						}
						is_controlled_by = ROOT
					}
					ROOT = {
						NOT = {
							original_tag = SOV
							has_government = communism
						}
					}
					NOT = {
						has_global_flag = renamed_leningrad_sov
					}
				}
				set_global_flag = renamed_leningrad_sov
				set_province_name = { id = 3151 name = "Saint Petersburg"}
				hidden_effect = {
					195 = {
						set_state_name = "Saint Petersburg"
					}
				}	
			}
			else_if = {
				limit = {
					FROM.FROM = {
						state = 195
					}
					ROOT = {
						TAG = SOV
						has_government = communism
					}
					195 = {
						NOT = {
							is_controlled_by = FROM
						}
						is_owned_and_controlled_by = ROOT
					}
					has_global_flag = renamed_leningrad_sov
				}
				clr_global_flag = renamed_leningrad_sov
				set_province_name = { id = 3151 name = "Leningrad"}
				hidden_effect = {
					195 = {
						set_state_name = "Leningrad"
					}
				}
			}
		}
	}

	#Set a country flag for major that send volunteers to WG durinf CW
	on_send_volunteers = {
		effect = {
			if = {
				limit = {
					ROOT = {
						has_country_flag = help_whiteguard_during_russian_civil_war
						has_idea = SOV_Participation_russian_civil_war_foreign
					}
					FROM = {
						TAG = SOV
						has_country_flag = second_civil_war_in_progress
					}
				}
				ROOT = {
					set_country_flag = has_helped_whiteguard_by_volunteers
				}	
			}
		}
	}

	#If Germany or Russia Attack eachother, cancel the right of ressources
	on_war_relation_added = {
		effect = {
			if = {
				limit = {
					ROOT = {
						TAG = GER
					}
					FROM = {
						TAG = SOV
						has_country_flag = has_negotiated_with_germany_ressource_rights
					}
				}
				ROOT = {
					remove_resource_rights = 582
					remove_resource_rights = 573
					remove_resource_rights = 581
					remove_resource_rights = 564
					remove_resource_rights = 232
					remove_resource_rights = 234
				}
			}
			else_if = {
				limit = {
					ROOT = {
						TAG = SOV
						has_country_flag = has_negotiated_with_germany_ressource_rights
					}
					FROM = {
						TAG = GER
					}
				}
				FROM = {
					remove_resource_rights = 582
					remove_resource_rights = 573
					remove_resource_rights = 581
					remove_resource_rights = 564
					remove_resource_rights = 232
					remove_resource_rights = 234
				}
			}
		}
	}

	#If Romania or Russia Attack eachother, cancel the righst of ressources
	on_war_relation_added = {
		effect = {
			if = {
				limit = {
					ROOT = {
						TAG = ROM
						OR = {
							has_country_flag = giving_46_rights_to_sov
							has_country_flag = giving_46_rights_to_sov_again
						}
					}
					FROM = {
						TAG = SOV
					}
				}
				FROM = {
					remove_resource_rights = 46
				}
			}
			else_if = {
				limit = {
					ROOT = {
						TAG = SOV
					}
					FROM = {
						TAG = ROM
						OR = {
							has_country_flag = giving_46_rights_to_sov
							has_country_flag = giving_46_rights_to_sov_again
						}
					}
				}
				ROOT = {
					remove_resource_rights = 46
				}
			}
		}
	}

	#Lock Division Template On Startup
	on_startup = {
		effect = {
			SOV = {
				if = {
					limit = {
						date < 1936.1.2
					}
					country_lock_all_division_template = yes
				}
			}
		}
	}

	#If Any Participant of the Yalta Conference Attack Russia and etc
	on_war_relation_added = {
		effect = {
			if = {
				limit = {
					ROOT = {
						OR = {
							TAG = ENG
							TAG = USA
							TAG = FRA
						}
						OR = {
							has_country_flag = eng_accepted_yalta_conference
							has_country_flag = usa_accepted_yalta_conference
							has_country_flag = fra_accepted_yalta_conference
						}
					}
					FROM = {
						TAG = SOV
						has_completed_focus = SOV_yalta_conference
						has_government = communism
						is_subject = no
						NOT = {
							has_country_flag = yalta_conference_over
						}
					}
				}
				ROOT = {
					clr_country_flag = eng_accepted_yalta_conference
					clr_country_flag = usa_accepted_yalta_conference
					clr_country_flag = fra_accepted_yalta_conference
				}
			}
			else_if = {
				limit = {
					FROM = {
						OR = {
							TAG = ENG
							TAG = USA
							TAG = FRA
						}
						OR = {
							has_country_flag = eng_accepted_yalta_conference
							has_country_flag = usa_accepted_yalta_conference
							has_country_flag = fra_accepted_yalta_conference
						}
					}
					ROOT = {
						TAG = SOV
						has_completed_focus = SOV_yalta_conference
						has_government = communism
						is_subject = no
						NOT = {
							has_country_flag = yalta_conference_over
						}
					}
				}
				FROM = {
					clr_country_flag = eng_accepted_yalta_conference
					clr_country_flag = usa_accepted_yalta_conference
					clr_country_flag = fra_accepted_yalta_conference
				}	
			}
		}
	}

	#If Italy or Russia Declare war on eachother while the diplomatic relation are up
	on_war_relation_added = {
		effect = {
			if = {
				limit = {
					ROOT = {
						TAG = ITA
					}
					FROM = {
						TAG = SOV
						has_country_flag = accept_diplomatic_relation_with_italy
					}
				}
				ROOT = {
					set_country_flag = has_compromised_russian_italian_relation
				}
			}
			else_if = {
				limit = {
					FROM = {
						TAG = ITA
					}
					ROOT = {
						TAG = SOV
						has_country_flag = accept_diplomatic_relation_with_italy
					}
				}
				FROM = {
					set_country_flag = has_compromised_russian_italian_relation
				}	
			}
		}
	}
}